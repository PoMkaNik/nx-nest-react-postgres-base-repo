# Сервис Postgresql DB
Используется как основная БД для работы сервисов бэкенда.

## Запуск в Docker

При разработке можно использовать существующий композ-конфиг `docker.dev.env`, он подхватывает все нужные переменные окружения.
Файлы формата `apps/*/docker*local.env` игнорируется гитом (в композе нужно скорректировать путь при этом). Но их использование не обязательно.

**Перед первым запуском** контейнера необходимо убедиться в наличии и переопределить при необходимости переменные окружения в файлах:
* файл `docker/.env.local`:
  * `POSTGRES_DB` - имя базы данных суперпользователя БД (по умолчанию `postgres`)
  * `POSTGRES_USER` - имя суперпользователя БД (по умолчанию `postgres`)
  * `POSTGRES_PASSWORD` - секретный пароль суперпользователя БД (переопределить)
* файл `.env.local`:
  * `NX_DB_NAME` - имя БД для бэкенд-сервисов (переопределить)
  * `NX_DB_USER` - пользователь для бэкенд-сервисов (переопределить)
  * `NX_DB_PASS` - секретный пароль пользователя для бэкенд-сервисов (переопределить)

Необходимо убедиться, что пользователи SU (`POSTGRES_USER`) и бэкекенда (`NX_DB_USER`) **отличаются**.

При первом запуске автоматически выполняются скрипты из папки `initdb.d`, которые включают в себя создание необходимых баз и создание пользователей.

В дальнейшем эти изменения придётся делать вручную прямым подключением к БД.

Запустить данный контейнер можно отдельным скриптом: `npm run docker:up:db`.

Удаление контейнера не приводит к удалению данных БД. Они хранятся по умолчанию по пути: `apps/postgresdb/.data`.
